{% extends 'base.html' %}

{% block head %}
    <title>{% if '/post/edit/' in request.path %}수정하기{% else %}새 글 쓰기{% endif %} - Jy's Blog</title>
{% endblock head %}

{% block title %}{% if '/post/edit/' in request.path %}수정하기{% else %}새 글 쓰기{% endif %}{% endblock title %}

{% block content %}
    <div class="post-box">
        <form id="post-form" method="post">
            {% csrf_token %}
            <div class="input-group mb-4">
                <div class="input-group-prepend">
                    <span class="input-group-text">제목</span>
                </div>
                {{ form.title }}
            </div>
            <div class="summernote-area">
                {{ form.text|safe }}
            </div>
            <div class="button-area text-right">
                <button id="btn-cancel" type="button" class="blog-button blog-button-md mr-2">취소</button>
                <button id="btn-submit" type="button" class="blog-button blog-button-md color-primary">
                    {% if '/post/edit/' in request.path %}수정하기{% else %}게시하기{% endif %}
                </button>
            </div>
        </form>
    </div>
{% endblock content %}

{% block script %}
    <script type="text/javascript">
        $(document).ready(function () {
            let checkUnload = true;

            $("#btn-cancel").click(function () {
                location.href = "{% url 'post_list' %}";
            });

            $(window).on('beforeunload', function () {
                if (checkUnload) return "변경사항이 저장되지 않았습니다. 사이트에서 나가시겠습니까?";
            });

            $("#btn-submit").click(function () {
                checkUnload = false;
                $("#post-form").submit();
            });
        });
    </script>
{% endblock script %}